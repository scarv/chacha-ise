\usepackage{amssymb}
\usepackage{amsmath}
\usepackage[plain,shortend]{algorithm2e}
\usepackage{bytefield}
\usepackage{caption}
\usepackage[inline]{enumitem}
\usepackage{etoolbox}
\usepackage[hidelinks]{hyperref}
\usepackage{import}
\usepackage{listings}
\usepackage{siunitx}
\usepackage{subcaption}
\usepackage{tikz}
\usepackage{todonotes}
\usepackage{xargs}
\usepackage{xspace}
\usepackage{xstring}
\usepackage{xcolor}
\usepackage{booktabs}
\usepackage{listings}
\usepackage{xcolor}

% set flags to conditionally control content in the paper (in addition to document class)
\newbool{submission} \setbool{submission}{false}
\newbool{anonymous}  \setbool{anonymous} {false}

% hack-ish control of space etc.
\captionsetup[subfigure]{justification=centering}
%\setlist{noitemsep,leftmargin=0.65\parindent,align=left,labelwidth=0.65\parindent,labelsep=2pt,topsep=2pt,partopsep=2pt,parsep=2pt}
%\setlength{\textfloatsep}{0.7\baselineskip plus 0.2\baselineskip minus 0.5\baselineskip}

\setlength{\algomargin}{0em}
\SetArgSty{textnormal}
\DontPrintSemicolon
\SetKwProg{KwFn}{function}{~begin}{end}

\newcommandx{\SEC}[1][1={}]{\IfEq{#1}{s}{Sections}{Section}\xspace}
\newcommandx{\TAB}[1][1={}]{\IfEq{#1}{s}{Tables}{Table}\xspace}
\newcommandx{\FIG}[1][1={}]{\IfEq{#1}{s}{Figures}{Figure}\xspace}
\newcommandx{\LST}[1][1={}]{\IfEq{#1}{s}{Listings}{Listing}\xspace}
\newcommandx{\APPX}[1][1={}]{\IfEq{#1}{s}{Appendices}{Appendix}\xspace}
\newcommandx{\REFSEC}[1]{\SEC~\ref{#1}\xspace}
\newcommandx{\REFTAB}[1]{\TAB~\ref{#1}\xspace}
\newcommandx{\REFFIG}[1]{\FIG~\ref{#1}\xspace}
\newcommandx{\REFLST}[1]{\LST~\ref{#1}\xspace}
\newcommandx{\REFAPPX}[1]{\APPX~\ref{#1}\xspace}
\newcommandx{\LSH}{\ensuremath{\ll}\xspace}
\newcommandx{\RSH}{\ensuremath{\gg}\xspace}
\newcommandx{\LRT}{\ensuremath{\lll}\xspace}
\newcommandx{\RRT}{\ensuremath{\ggg}\xspace}
\newcommandx{\NAND}{\ensuremath{\;\overline{\wedge}\;}\xspace}
\newcommandx{\NIOR}{\ensuremath{\;\overline{\vee}\;}\xspace}
\newcommandx{\NXOR}{\ensuremath{\;\overline{\oplus}\;}\xspace}
\newcommandx{\XNOR}{\ensuremath{\;\overline{\oplus}\;}\xspace}
\newcommandx{\NOT}{\ensuremath{\neg  }\xspace}
\newcommandx{\AND}{\ensuremath{\wedge}\xspace}
\newcommandx{\IOR}{\ensuremath{\vee  }\xspace}
\newcommandx{\XOR}{\ensuremath{\oplus}\xspace}
\newcommandx{\TUPLE}[1]{\ensuremath{({#1})}\xspace}
\newcommandx{\TABLE}[1]{\ensuremath{[{#1}]}\xspace}
\newcommandx{\LIST}[1]{\ensuremath{\langle{#1}\rangle}\xspace}
\newcommandx{\SET}[1]{\ensuremath{\{{#1}\}}\xspace}
\newcommandx{\RADIX}[2]{\ensuremath{{#1}_{({#2})}}\xspace}
\newcommandx{\CONS}{\ensuremath{\;\parallel\;}\xspace}
\newcommandx{\ASN}{\ensuremath{\leftarrow}\xspace}
\newcommandx{\RAND}{\ensuremath{\xleftarrow{\$}}\xspace}
\newcommandx{\ALG}[1]{\ensuremath\textsc{#1}\xspace}
\newcommandx{\MEM}[2][1={},2={}     ]{{\ensuremath\IfEq{#1}{*}{{\sf MEM}[{#2}]}{{\sf MEM}}}\xspace}
\newcommandx{\GPR}[2][1={},2={}     ]{{\ensuremath\IfEq{#1}{*}{{\sf GPR}[{#2}]}{{\sf GPR}}}\xspace}
\newcommandx{\SPR}[3][     2={},3={}]{{\ensuremath\IfEq{#2}{*}{{\sf  #1}[{#3}]}{{\sf  #1}}}\xspace}

\newcommandx{\GMASKED}[1]{\tilde{#1}\xspace}

\newcommandx{\BMASK}[2]  {#1 \XOR #2\xspace}  
\newcommandx{\BUNMASK}[2]{#1 \XOR #2\xspace}
\newcommandx{\BMASKED}[1]{\hat{#1}\xspace}

\newcommandx{\AMASK}[2]  {#1 +    #2 \pmod{2^w}\xspace}
\newcommandx{\AUNMASK}[2]{#1 -    #2 \pmod{2^w}\xspace}
\newcommandx{\AMASKED}[1]{\bar{#1}\xspace}

\newcommandx{\RVXLEN}[1][1={}]{\IfEq{#1}{}{{\rm XLEN}}{{\rm #1-XLEN}}\xspace}
\newcommandx{\RVCUSTOM}[1]{\mbox{\em custom-#1}\xspace}

\newcommandx{\CORE}{\ifbool{anonymous}{Anonymous}{SCARV}\xspace}

\newcommandx{\INST}[2]{
\item \VERB[ASM]{#1}

      \begin{algorithm}[H]
      \Begin {
        #2
      }
      \end{algorithm}
}

\lstdefinestyle{inline}{
  escapechar={¬},
  basicstyle=\ttfamily, 
  keywordstyle=\ttfamily, 
  breakautoindent=false,
  breaklines=false,
  breakatwhitespace=false,
  keepspaces=true,
  showstringspaces=false
}
\lstdefinestyle{float}{
  escapechar={¬},
  basicstyle=\ttfamily\scriptsize,  
  breakautoindent=false,
  breaklines=false,
  breakatwhitespace=false,
  keepspaces=true,
  showstringspaces=false,
  frame=single,
  numbers=left
}
\lstdefinestyle{block}{
  escapechar={¬},
  basicstyle=\ttfamily\scriptsize,  
  breakautoindent=false,
  breaklines=false,
  breakatwhitespace=false,
  keepspaces=true,
  showstringspaces=false,
  frame=single,
  numbers=left
}
\newcommand{\VERB}[2][]{\mbox{\lstinline[style={inline},language={#1}]`#2`}}
\lstnewenvironment{MKVERB}[1][]{\lstset{basicstyle=\ttfamily,#1}}{}
\lstalias{ASM}{C}

\definecolor{codegreen}{rgb}{0,0.6,0}
\definecolor{codegray}{rgb}{0.5,0.5,0.5}
\definecolor{codepurple}{rgb}{0.58,0,0.82}
\definecolor{backcolour}{rgb}{0.95,0.95,0.92}

\lstdefinestyle{mystyle}{
	backgroundcolor=\color{backcolour},   
	commentstyle=\color{codegreen},
	keywordstyle=\color{magenta},
	numberstyle=\tiny\color{codegray},
	stringstyle=\color{codepurple},
	basicstyle=\ttfamily\footnotesize,
	breakatwhitespace=false,         
	breaklines=true,                 
	captionpos=b,                    
	keepspaces=true,                 
	numbers=left,                    
	numbersep=5pt,                  
	showspaces=false,                
	showstringspaces=false,
	showtabs=false,                  
	tabsize=2
}
